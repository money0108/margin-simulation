● 專案已完成。以下是完整的遠期契約保證金模擬平台摘要：

  專案結構

  P:\Claude Example2\遠期_新\保證金模擬平台\
  ├── app.py                      # Streamlit 主程式
  ├── requirements.txt            # 依賴套件
  ├── README.md                   # 使用說明
  ├── config/
  │   └── settings.yaml           # 設定檔（路徑、槓桿、折減規則）
  ├── core/
  │   ├── __init__.py
  │   ├── data_loader.py          # 資料載入與驗證
  │   ├── instruments.py          # 標的分類與 ETF look-through
  │   ├── buckets.py              # 產業桶分類與 3M 報酬計算
  │   ├── margin.py               # 保證金計算核心
  │   ├── engine.py               # 回測引擎
  │   └── reporting.py            # 報表與稽核包
  └── tests/
      ├── __init__.py
      ├── test_margin_rules.py    # 保證金規則測試
      ├── test_etf_lookthrough.py # ETF look-through 測試
      └── test_bucket_reduction.py# 產業桶折減測試

  執行方式

  # 安裝依賴
  cd "P:\Claude Example2\遠期_新\保證金模擬平台"
  pip install -r requirements.txt

  # 執行 Streamlit 應用
  streamlit run app.py

  # 執行單元測試
  pytest tests/ -v

  核心功能
  ┌──────────────────┬────────────────────────────────────────────┐
  │       功能       │                    說明                    │
  ├──────────────────┼────────────────────────────────────────────┤
  │ 部位載入         │ 支援 Excel 上傳或載入示範部位              │
  ├──────────────────┼────────────────────────────────────────────┤
  │ 槓桿計算         │ 依股期槓桿動態判定：>7→5x, >6且≤7→4x,     │
  │                  │ ≤6→3x；ETF 月均量≥萬張→7x 否則5x；其他 3x  │
  ├──────────────────┼────────────────────────────────────────────┤
  │ ETF Look-through │ 0050/0056 拆解至成分股，完全對沖 100% 減收 │
  ├──────────────────┼────────────────────────────────────────────┤
  │ 產業桶分類       │ 電子、金融、非金電三桶                     │
  ├──────────────────┼────────────────────────────────────────────┤
  │ 對沖折減         │ 同桶 50%/20%、跨桶 20%                     │
  ├──────────────────┼────────────────────────────────────────────┤
  │ 追繳判定         │ Equity < MM(70%) → 回補至 IM(100%)         │
  ├──────────────────┼────────────────────────────────────────────┤
  │ 稽核包           │ 輸入快照、計算步驟、假設說明               │
  └──────────────────┴────────────────────────────────────────────┘
  測試結果

  tests/test_bucket_reduction.py     5 passed
  tests/test_etf_lookthrough.py      4 passed
  tests/test_margin_rules.py         4 passed
  ======================================
  Total: 13 passed

  平台已可直接執行，支援讀取您的歷史數據與示範部位進行完整的保證金模擬回測。